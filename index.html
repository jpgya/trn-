<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>フォートナイトトラッカー</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-r from-purple-700 via-indigo-600 to-pink-500 min-h-screen flex items-center justify-center p-4">

  <div class="bg-white rounded-2xl shadow-2xl max-w-lg w-full p-6 md:p-8">
    <h1 class="text-2xl md:text-3xl font-bold text-center text-gray-800 mb-6">Fortnite Tracker</h1>
    
    <form class="flex flex-col gap-4">
      <div>
        <label for="id" class="block text-sm md:text-base font-medium text-gray-700 mb-1">EPIC ID</label>
        <input
          type="text"
          id="id"
          placeholder="EPIC ID を入力"
          oninput="inputCheck()"
          class="w-full rounded-lg border border-gray-300 px-4 py-3 text-gray-800 focus:ring-indigo-400 focus:outline-none transition"
        />
      </div>

      <a id="trackerLink"
         target="_blank"
         rel="noopener noreferrer"
         class="hidden mt-2 block text-center bg-indigo-600 text-white font-bold py-3 rounded-lg transition-all duration-200 hover:bg-indigo-500 hover:scale-105">
         トラッカーを確認する
      </a>

      <p id="infoMessage" class="text-gray-500 text-sm mt-2">EPIC ID を入力してください</p>
    </form>

    <div id="historyContainer" class="mt-6">
      <h2 class="text-gray-700 font-medium mb-2">最近の検索</h2>
      <ul id="historyList" class="list-disc list-inside text-gray-600 text-sm"></ul>
    </div>
  </div>

  <script>
    const historyList = document.getElementById("historyList");

    function saveHistory(epicId) {
      let history = JSON.parse(localStorage.getItem("epicHistory") || "[]");
      if (!history.includes(epicId)) {
        history.unshift(epicId);
        if (history.length > 5) history.pop(); // 最大5件
        localStorage.setItem("epicHistory", JSON.stringify(history));
        renderHistory();
      }
    }

    function renderHistory() {
      let history = JSON.parse(localStorage.getItem("epicHistory") || "[]");
      historyList.innerHTML = "";
      history.forEach(id => {
        const li = document.createElement("li");
        li.textContent = id;
        li.classList.add("cursor-pointer", "hover:text-indigo-600");
        li.onclick = () => {
          document.getElementById("id").value = id;
          inputCheck();
        };
        historyList.appendChild(li);
      });
    }

    function inputCheck() {
      const inputField = document.getElementById("id");
      let inputValue = inputField.value.trim().replace(/\s/g, "");
      inputValue = inputValue.toUpperCase(); // 大文字に統一
      const link = document.getElementById("trackerLink");
      const infoMessage = document.getElementById("infoMessage");

      if (inputValue) {
        link.href = "https://fortnitetracker.com/profile/all/" + encodeURIComponent(inputValue) + "/events";
        link.textContent = "トラッカーを確認する";
        link.classList.remove("hidden");
        infoMessage.textContent = "";
        saveHistory(inputValue);
      } else {
        link.classList.add("hidden");
        infoMessage.textContent = "EPIC ID を入力してください";
      }
    }

    // ページ読み込み時に履歴を表示
    renderHistory();
  </script>

</body>
</html>
